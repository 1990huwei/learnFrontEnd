<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML5å¤šåª’ä½“ä¸APIå®Œæ•´ç¤ºä¾‹</title>
    <meta name="description" content="å±•ç¤ºHTML5å¤šåª’ä½“å…ƒç´ å’Œç°ä»£Web APIçš„å®Œæ•´ä½¿ç”¨ç¤ºä¾‹">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .section {
            background: white;
            margin-bottom: 30px;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .section:hover {
            transform: translateY(-5px);
        }
        
        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .section h3 {
            color: #555;
            margin: 20px 0 15px 0;
            font-size: 1.3em;
        }
        
        /* è§†é¢‘æ ·å¼ */
        .video-container {
            position: relative;
            margin: 20px 0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        video {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .custom-controls {
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .control-btn:hover {
            background: #5a6fd8;
        }
        
        .control-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .progress-container {
            flex: 1;
            height: 6px;
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
            cursor: pointer;
            position: relative;
        }
        
        .progress-bar {
            height: 100%;
            background: #667eea;
            border-radius: 3px;
            transition: width 0.1s;
        }
        
        .time-display {
            font-size: 0.9em;
            min-width: 80px;
        }
        
        .volume-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .volume-slider {
            width: 80px;
        }
        
        /* éŸ³é¢‘æ ·å¼ */
        .audio-container {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .audio-player {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .audio-info {
            flex: 1;
            min-width: 200px;
        }
        
        .track-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .track-artist {
            opacity: 0.8;
        }
        
        /* Canvasæ ·å¼ */
        .canvas-container {
            text-align: center;
            margin: 20px 0;
        }
        
        canvas {
            border: 2px solid #667eea;
            border-radius: 10px;
            cursor: crosshair;
            max-width: 100%;
            height: auto;
        }
        
        .canvas-controls {
            margin: 15px 0;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .color-picker {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .brush-size {
            width: 100px;
        }
        
        /* åœ°ç†ä½ç½®æ ·å¼ */
        .location-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }
        
        .location-data {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .data-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .data-label {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        /* å­˜å‚¨ç¤ºä¾‹æ ·å¼ */
        .storage-demo {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .storage-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        
        .storage-section h4 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .input-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #5a6fd8;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .storage-display {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            min-height: 100px;
            border: 1px solid #ddd;
        }
        
        /* æ‹–æ‹½ä¸Šä¼ æ ·å¼ */
        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .upload-area.dragover {
            border-color: #5a6fd8;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .upload-area:hover {
            border-color: #5a6fd8;
        }
        
        .file-list {
            margin-top: 20px;
        }
        
        .file-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .file-info {
            flex: 1;
        }
        
        .file-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .file-size {
            color: #666;
            font-size: 0.9em;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .section {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .custom-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .audio-player {
                flex-direction: column;
            }
            
            .canvas-controls {
                flex-direction: column;
                align-items: center;
            }
        }
        
        /* åŠ¨ç”» */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section {
            animation: fadeIn 0.6s ease-out;
        }
        
        /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>HTML5å¤šåª’ä½“ä¸APIç¤ºä¾‹</h1>
            <p class="subtitle">æ¢ç´¢ç°ä»£WebæŠ€æœ¯çš„å¼ºå¤§åŠŸèƒ½</p>
        </header>
        
        <!-- è§†é¢‘éƒ¨åˆ† -->
        <section class="section">
            <h2>ğŸ¥ HTML5è§†é¢‘æ’­æ”¾å™¨</h2>
            <p>è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„HTML5è§†é¢‘æ’­æ”¾å™¨ï¼Œå±•ç¤ºäº†è§†é¢‘å…ƒç´ çš„å„ç§åŠŸèƒ½å’Œæ§åˆ¶é€‰é¡¹ã€‚</p>
            
            <div class="video-container">
                <video id="mainVideo" width="800" height="450" poster="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwIiBoZWlnaHQ9IjQ1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjNjY3ZWVhIi8+CiAgPHRleHQgeD0iNTAlIiB5PSI0NSUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyNCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPuinhumikea1i+ivleWZqDwvdGV4dD4KICA8dGV4dCB4PSI1MCUiIHk9IjU1JSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE2IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+ODAwIHggNDUwPC90ZXh0Pgo8L3N2Zz4K">
                    <!-- æ³¨æ„ï¼šåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæ‚¨éœ€è¦æä¾›çœŸå®çš„è§†é¢‘æ–‡ä»¶ -->
                    <source src="sample-video.mp4" type="video/mp4">
                    <source src="sample-video.webm" type="video/webm">
                    <track kind="captions" src="captions-zh.vtt" srclang="zh" label="ä¸­æ–‡å­—å¹•" default>
                    <track kind="captions" src="captions-en.vtt" srclang="en" label="English Subtitles">
                    <p>æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚è¯·å‡çº§æ‚¨çš„æµè§ˆå™¨æˆ–<a href="sample-video.mp4">ä¸‹è½½è§†é¢‘</a>ã€‚</p>
                </video>
                
                <div class="custom-controls">
                    <button class="control-btn" id="playPauseBtn">â–¶ï¸ æ’­æ”¾</button>
                    <button class="control-btn" id="stopBtn">â¹ï¸ åœæ­¢</button>
                    <button class="control-btn" id="muteBtn">ğŸ”Š é™éŸ³</button>
                    
                    <div class="progress-container" id="progressContainer">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                    
                    <span class="time-display" id="timeDisplay">00:00 / 00:00</span>
                    
                    <div class="volume-control">
                        <span>éŸ³é‡:</span>
                        <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.1" value="1">
                    </div>
                    
                    <button class="control-btn" id="fullscreenBtn">â›¶ å…¨å±</button>
                    <button class="control-btn" id="speedBtn">1x</button>
                </div>
            </div>
            
            <h3>è§†é¢‘ä¿¡æ¯</h3>
            <div id="videoInfo" class="status info">
                ç‚¹å‡»æ’­æ”¾æŒ‰é’®å¼€å§‹æ’­æ”¾è§†é¢‘
            </div>
        </section>
        
        <!-- éŸ³é¢‘éƒ¨åˆ† -->
        <section class="section">
            <h2>ğŸµ HTML5éŸ³é¢‘æ’­æ”¾å™¨</h2>
            <p>è‡ªå®šä¹‰éŸ³é¢‘æ’­æ”¾å™¨ï¼Œæ”¯æŒæ’­æ”¾åˆ—è¡¨å’Œå¯è§†åŒ–æ•ˆæœã€‚</p>
            
            <div class="audio-container">
                <div class="audio-player">
                    <div class="audio-info">
                        <div class="track-title" id="trackTitle">ç¤ºä¾‹éŸ³é¢‘æ–‡ä»¶</div>
                        <div class="track-artist" id="trackArtist">HTML5 Audio Demo</div>
                    </div>
                    
                    <div class="audio-controls">
                        <button class="control-btn" id="prevBtn">â®ï¸</button>
                        <button class="control-btn" id="audioPlayBtn">â–¶ï¸</button>
                        <button class="control-btn" id="nextBtn">â­ï¸</button>
                    </div>
                </div>
                
                <audio id="audioPlayer" preload="metadata">
                    <source src="sample-audio.mp3" type="audio/mpeg">
                    <source src="sample-audio.ogg" type="audio/ogg">
                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
                </audio>
                
                <!-- éŸ³é¢‘å¯è§†åŒ– -->
                <canvas id="audioVisualizer" width="400" height="100" style="width: 100%; height: 100px; margin-top: 15px; border-radius: 5px;"></canvas>
            </div>
            
            <h3>æ’­æ”¾åˆ—è¡¨</h3>
            <div id="playlist">
                <div class="file-item">
                    <div class="file-info">
                        <div class="file-name">ç¤ºä¾‹éŸ³é¢‘ 1</div>
                        <div class="file-size">3:24</div>
                    </div>
                    <button class="btn" onclick="playTrack(0)">æ’­æ”¾</button>
                </div>
            </div>
        </section>
        
        <!-- Canvasç»˜å›¾ -->
        <section class="section">
            <h2>ğŸ¨ Canvasç»˜å›¾æ¿</h2>
            <p>ä½¿ç”¨HTML5 Canvas APIåˆ›å»ºçš„äº¤äº’å¼ç»˜å›¾æ¿ã€‚</p>
            
            <div class="canvas-container">
                <canvas id="drawingCanvas" width="800" height="400"></canvas>
                
                <div class="canvas-controls">
                    <input type="color" id="colorPicker" class="color-picker" value="#667eea">
                    <label for="brushSize">ç”»ç¬”å¤§å°:</label>
                    <input type="range" id="brushSize" class="brush-size" min="1" max="50" value="5">
                    <span id="brushSizeDisplay">5px</span>
                    
                    <button class="btn" id="clearCanvas">æ¸…ç©ºç”»å¸ƒ</button>
                    <button class="btn" id="saveCanvas">ä¿å­˜å›¾ç‰‡</button>
                    <button class="btn" id="undoBtn">æ’¤é”€</button>
                </div>
            </div>
        </section>
        
        <!-- åœ°ç†ä½ç½®API -->
        <section class="section">
            <h2>ğŸ“ åœ°ç†ä½ç½®API</h2>
            <p>è·å–ç”¨æˆ·çš„åœ°ç†ä½ç½®ä¿¡æ¯å¹¶æ˜¾ç¤ºç›¸å…³æ•°æ®ã€‚</p>
            
            <button class="btn" id="getLocationBtn">è·å–æˆ‘çš„ä½ç½®</button>
            <button class="btn btn-secondary" id="watchLocationBtn">ç›‘å¬ä½ç½®å˜åŒ–</button>
            <button class="btn btn-danger" id="stopWatchBtn" disabled>åœæ­¢ç›‘å¬</button>
            
            <div id="locationStatus" class="status info" style="display: none;">
                æ­£åœ¨è·å–ä½ç½®ä¿¡æ¯...
            </div>
            
            <div class="location-info" id="locationInfo" style="display: none;">
                <h3>ä½ç½®ä¿¡æ¯</h3>
                <div class="location-data">
                    <div class="data-item">
                        <div class="data-label">çº¬åº¦</div>
                        <div id="latitude">-</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">ç»åº¦</div>
                        <div id="longitude">-</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">ç²¾åº¦</div>
                        <div id="accuracy">-</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">æµ·æ‹”</div>
                        <div id="altitude">-</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">é€Ÿåº¦</div>
                        <div id="speed">-</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">æ–¹å‘</div>
                        <div id="heading">-</div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- æœ¬åœ°å­˜å‚¨ -->
        <section class="section">
            <h2>ğŸ’¾ æœ¬åœ°å­˜å‚¨API</h2>
            <p>æ¼”ç¤ºlocalStorageã€sessionStorageå’ŒIndexedDBçš„ä½¿ç”¨ã€‚</p>
            
            <div class="storage-demo">
                <div class="storage-section">
                    <h4>localStorage</h4>
                    <div class="input-group">
                        <label for="localKey">é”®å:</label>
                        <input type="text" id="localKey" placeholder="è¾“å…¥é”®å">
                    </div>
                    <div class="input-group">
                        <label for="localValue">å€¼:</label>
                        <input type="text" id="localValue" placeholder="è¾“å…¥å€¼">
                    </div>
                    <button class="btn" onclick="setLocalStorage()">ä¿å­˜</button>
                    <button class="btn btn-secondary" onclick="getLocalStorage()">è·å–</button>
                    <button class="btn btn-danger" onclick="clearLocalStorage()">æ¸…ç©º</button>
                    
                    <div class="storage-display" id="localStorageDisplay">
                        localStorageå†…å®¹å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ
                    </div>
                </div>
                
                <div class="storage-section">
                    <h4>sessionStorage</h4>
                    <div class="input-group">
                        <label for="sessionKey">é”®å:</label>
                        <input type="text" id="sessionKey" placeholder="è¾“å…¥é”®å">
                    </div>
                    <div class="input-group">
                        <label for="sessionValue">å€¼:</label>
                        <input type="text" id="sessionValue" placeholder="è¾“å…¥å€¼">
                    </div>
                    <button class="btn" onclick="setSessionStorage()">ä¿å­˜</button>
                    <button class="btn btn-secondary" onclick="getSessionStorage()">è·å–</button>
                    <button class="btn btn-danger" onclick="clearSessionStorage()">æ¸…ç©º</button>
                    
                    <div class="storage-display" id="sessionStorageDisplay">
                        sessionStorageå†…å®¹å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ
                    </div>
                </div>
            </div>
        </section>
        
        <!-- æ–‡ä»¶API -->
        <section class="section">
            <h2>ğŸ“ æ–‡ä»¶API</h2>
            <p>æ‹–æ‹½ä¸Šä¼ æ–‡ä»¶å¹¶è¯»å–æ–‡ä»¶å†…å®¹ã€‚</p>
            
            <div class="upload-area" id="uploadArea">
                <p>ğŸ“ æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œæˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</p>
                <input type="file" id="fileInput" multiple style="display: none;">
            </div>
            
            <div class="file-list" id="fileList"></div>
        </section>
        
        <!-- Web Workers -->
        <section class="section">
            <h2>âš¡ Web Workers</h2>
            <p>ä½¿ç”¨Web Workersè¿›è¡Œåå°è®¡ç®—ï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹ã€‚</p>
            
            <div class="input-group">
                <label for="numberInput">è®¡ç®—æ•°å­—çš„é˜¶ä¹˜:</label>
                <input type="number" id="numberInput" value="10" min="1" max="20">
            </div>
            
            <button class="btn" id="calculateBtn">å¼€å§‹è®¡ç®—</button>
            <button class="btn btn-secondary" id="calculateSyncBtn">åŒæ­¥è®¡ç®—ï¼ˆä¼šé˜»å¡ï¼‰</button>
            
            <div id="workerResult" class="status info" style="display: none;">
                è®¡ç®—ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ
            </div>
            
            <div id="performanceInfo" style="margin-top: 15px;">
                <p>ç‚¹å‡»æŒ‰é’®æµ‹è¯•æ€§èƒ½å·®å¼‚ï¼š</p>
                <ul>
                    <li>Web Workerè®¡ç®—ï¼šä¸ä¼šé˜»å¡é¡µé¢äº¤äº’</li>
                    <li>åŒæ­¥è®¡ç®—ï¼šä¼šé˜»å¡é¡µé¢ï¼Œå¯¼è‡´ç•Œé¢å¡é¡¿</li>
                </ul>
            </div>
        </section>
    </div>
    
    <script>
        // è§†é¢‘æ’­æ”¾å™¨åŠŸèƒ½
        const video = document.getElementById('mainVideo');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const stopBtn = document.getElementById('stopBtn');
        const muteBtn = document.getElementById('muteBtn');
        const progressContainer = document.getElementById('progressContainer');
        const progressBar = document.getElementById('progressBar');
        const timeDisplay = document.getElementById('timeDisplay');
        const volumeSlider = document.getElementById('volumeSlider');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const speedBtn = document.getElementById('speedBtn');
        const videoInfo = document.getElementById('videoInfo');
        
        let playbackSpeeds = [0.5, 1, 1.25, 1.5, 2];
        let currentSpeedIndex = 1;
        
        // æ’­æ”¾/æš‚åœ
        playPauseBtn.addEventListener('click', () => {
            if (video.paused) {
                video.play();
                playPauseBtn.textContent = 'â¸ï¸ æš‚åœ';
            } else {
                video.pause();
                playPauseBtn.textContent = 'â–¶ï¸ æ’­æ”¾';
            }
        });
        
        // åœæ­¢
        stopBtn.addEventListener('click', () => {
            video.pause();
            video.currentTime = 0;
            playPauseBtn.textContent = 'â–¶ï¸ æ’­æ”¾';
        });
        
        // é™éŸ³
        muteBtn.addEventListener('click', () => {
            video.muted = !video.muted;
            muteBtn.textContent = video.muted ? 'ğŸ”‡ å–æ¶ˆé™éŸ³' : 'ğŸ”Š é™éŸ³';
        });
        
        // éŸ³é‡æ§åˆ¶
        volumeSlider.addEventListener('input', () => {
            video.volume = volumeSlider.value;
        });
        
        // è¿›åº¦æ¡
        video.addEventListener('timeupdate', () => {
            const progress = (video.currentTime / video.duration) * 100;
            progressBar.style.width = progress + '%';
            
            const currentMinutes = Math.floor(video.currentTime / 60);
            const currentSeconds = Math.floor(video.currentTime % 60);
            const durationMinutes = Math.floor(video.duration / 60);
            const durationSeconds = Math.floor(video.duration % 60);
            
            timeDisplay.textContent = 
                `${currentMinutes.toString().padStart(2, '0')}:${currentSeconds.toString().padStart(2, '0')} / ` +
                `${durationMinutes.toString().padStart(2, '0')}:${durationSeconds.toString().padStart(2, '0')}`;
        });
        
        // ç‚¹å‡»è¿›åº¦æ¡è·³è½¬
        progressContainer.addEventListener('click', (e) => {
            const rect = progressContainer.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const width = rect.width;
            const newTime = (clickX / width) * video.duration;
            video.currentTime = newTime;
        });
        
        // å…¨å±
        fullscreenBtn.addEventListener('click', () => {
            if (video.requestFullscreen) {
                video.requestFullscreen();
            } else if (video.webkitRequestFullscreen) {
                video.webkitRequestFullscreen();
            } else if (video.msRequestFullscreen) {
                video.msRequestFullscreen();
            }
        });
        
        // æ’­æ”¾é€Ÿåº¦
        speedBtn.addEventListener('click', () => {
            currentSpeedIndex = (currentSpeedIndex + 1) % playbackSpeeds.length;
            const speed = playbackSpeeds[currentSpeedIndex];
            video.playbackRate = speed;
            speedBtn.textContent = speed + 'x';
        });
        
        // è§†é¢‘äº‹ä»¶ç›‘å¬
        video.addEventListener('loadstart', () => {
            videoInfo.textContent = 'å¼€å§‹åŠ è½½è§†é¢‘...';
            videoInfo.className = 'status info';
        });
        
        video.addEventListener('loadedmetadata', () => {
            videoInfo.textContent = `è§†é¢‘å·²åŠ è½½ - åˆ†è¾¨ç‡: ${video.videoWidth}x${video.videoHeight}, æ—¶é•¿: ${Math.floor(video.duration)}ç§’`;
            videoInfo.className = 'status success';
        });
        
        video.addEventListener('error', () => {
            videoInfo.textContent = 'è§†é¢‘åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„';
            videoInfo.className = 'status error';
        });
        
        // éŸ³é¢‘æ’­æ”¾å™¨åŠŸèƒ½
        const audioPlayer = document.getElementById('audioPlayer');
        const audioPlayBtn = document.getElementById('audioPlayBtn');
        const audioVisualizer = document.getElementById('audioVisualizer');
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let audioSource, analyser, dataArray;
        
        // éŸ³é¢‘å¯è§†åŒ–è®¾ç½®
        function setupAudioVisualization() {
            if (!audioSource) {
                audioSource = audioCtx.createMediaElementSource(audioPlayer);
                analyser = audioCtx.createAnalyser();
                audioSource.connect(analyser);
                analyser.connect(audioCtx.destination);
                
                analyser.fftSize = 256;
                const bufferLength = analyser.frequencyBinCount;
                dataArray = new Uint8Array(bufferLength);
            }
        }
        
        // ç»˜åˆ¶éŸ³é¢‘å¯è§†åŒ–
        function drawAudioVisualization() {
            if (!analyser) return;
            
            const canvas = audioVisualizer;
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            analyser.getByteFrequencyData(dataArray);
            
            ctx.fillStyle = 'rgba(102, 126, 234, 0.1)';
            ctx.fillRect(0, 0, width, height);
            
            const barWidth = (width / dataArray.length) * 2.5;
            let barHeight;
            let x = 0;
            
            for (let i = 0; i < dataArray.length; i++) {
                barHeight = (dataArray[i] / 255) * height;
                
                const r = barHeight + 25 * (i / dataArray.length);
                const g = 250 * (i / dataArray.length);
                const b = 50;
                
                ctx.fillStyle = `rgb(${r},${g},${b})`;
                ctx.fillRect(x, height - barHeight, barWidth, barHeight);
                
                x += barWidth + 1;
            }
            
            requestAnimationFrame(drawAudioVisualization);
        }
        
        audioPlayBtn.addEventListener('click', () => {
            if (audioPlayer.paused) {
                setupAudioVisualization();
                audioPlayer.play();
                audioPlayBtn.textContent = 'â¸ï¸';
                drawAudioVisualization();
            } else {
                audioPlayer.pause();
                audioPlayBtn.textContent = 'â–¶ï¸';
            }
        });
        
        // Canvasç»˜å›¾åŠŸèƒ½
        const canvas = document.getElementById('drawingCanvas');
        const ctx = canvas.getContext('2d');
        const colorPicker = document.getElementById('colorPicker');
        const brushSize = document.getElementById('brushSize');
        const brushSizeDisplay = document.getElementById('brushSizeDisplay');
        const clearCanvas = document.getElementById('clearCanvas');
        const saveCanvas = document.getElementById('saveCanvas');
        const undoBtn = document.getElementById('undoBtn');
        
        let isDrawing = false;
        let drawingHistory = [];
        
        // ä¿å­˜ç”»å¸ƒçŠ¶æ€
        function saveCanvasState() {
            drawingHistory.push(canvas.toDataURL());
            if (drawingHistory.length > 10) {
                drawingHistory.shift();
            }
        }
        
        // åˆå§‹ä¿å­˜ç©ºç™½ç”»å¸ƒ
        saveCanvasState();
        
        // ç”»ç¬”å¤§å°æ˜¾ç¤º
        brushSize.addEventListener('input', () => {
            brushSizeDisplay.textContent = brushSize.value + 'px';
        });
        
        // é¼ æ ‡äº‹ä»¶
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);
        
        // è§¦æ‘¸äº‹ä»¶ï¼ˆç§»åŠ¨è®¾å¤‡æ”¯æŒï¼‰
        canvas.addEventListener('touchstart', handleTouch);
        canvas.addEventListener('touchmove', handleTouch);
        canvas.addEventListener('touchend', stopDrawing);
        
        function startDrawing(e) {
            isDrawing = true;
            saveCanvasState();
            draw(e);
        }
        
        function draw(e) {
            if (!isDrawing) return;
            
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            ctx.lineWidth = brushSize.value;
            ctx.lineCap = 'round';
            ctx.strokeStyle = colorPicker.value;
            
            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x, y);
        }
        
        function stopDrawing() {
            if (isDrawing) {
                isDrawing = false;
                ctx.beginPath();
            }
        }
        
        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                            e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }
        
        // æ¸…ç©ºç”»å¸ƒ
        clearCanvas.addEventListener('click', () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            saveCanvasState();
        });
        
        // ä¿å­˜å›¾ç‰‡
        saveCanvas.addEventListener('click', () => {
            const link = document.createElement('a');
            link.download = 'drawing.png';
            link.href = canvas.toDataURL();
            link.click();
        });
        
        // æ’¤é”€
        undoBtn.addEventListener('click', () => {
            if (drawingHistory.length > 1) {
                drawingHistory.pop();
                const img = new Image();
                img.onload = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(img, 0, 0);
                };
                img.src = drawingHistory[drawingHistory.length - 1];
            }
        });
        
        // åœ°ç†ä½ç½®API
        const getLocationBtn = document.getElementById('getLocationBtn');
        const watchLocationBtn = document.getElementById('watchLocationBtn');
        const stopWatchBtn = document.getElementById('stopWatchBtn');
        const locationStatus = document.getElementById('locationStatus');
        const locationInfo = document.getElementById('locationInfo');
        
        let watchId = null;
        
        function displayLocation(position) {
            const coords = position.coords;
            
            document.getElementById('latitude').textContent = coords.latitude.toFixed(6);
            document.getElementById('longitude').textContent = coords.longitude.toFixed(6);
            document.getElementById('accuracy').textContent = coords.accuracy + ' ç±³';
            document.getElementById('altitude').textContent = coords.altitude ? coords.altitude.toFixed(2) + ' ç±³' : 'ä¸å¯ç”¨';
            document.getElementById('speed').textContent = coords.speed ? coords.speed.toFixed(2) + ' m/s' : 'ä¸å¯ç”¨';
            document.getElementById('heading').textContent = coords.heading ? coords.heading.toFixed(2) + 'Â°' : 'ä¸å¯ç”¨';
            
            locationStatus.style.display = 'none';
            locationInfo.style.display = 'block';
        }
        
        function handleLocationError(error) {
            let message = '';
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    message = 'ç”¨æˆ·æ‹’ç»äº†åœ°ç†ä½ç½®è¯·æ±‚';
                    break;
                case error.POSITION_UNAVAILABLE:
                    message = 'ä½ç½®ä¿¡æ¯ä¸å¯ç”¨';
                    break;
                case error.TIMEOUT:
                    message = 'è¯·æ±‚è¶…æ—¶';
                    break;
                default:
                    message = 'è·å–ä½ç½®æ—¶å‘ç”ŸæœªçŸ¥é”™è¯¯';
                    break;
            }
            
            locationStatus.textContent = message;
            locationStatus.className = 'status error';
        }
        
        getLocationBtn.addEventListener('click', () => {
            if (navigator.geolocation) {
                locationStatus.style.display = 'block';
                locationStatus.textContent = 'æ­£åœ¨è·å–ä½ç½®ä¿¡æ¯...';
                locationStatus.className = 'status info';
                
                navigator.geolocation.getCurrentPosition(displayLocation, handleLocationError, {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 60000
                });
            } else {
                alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒåœ°ç†ä½ç½®API');
            }
        });
        
        watchLocationBtn.addEventListener('click', () => {
            if (navigator.geolocation) {
                watchId = navigator.geolocation.watchPosition(displayLocation, handleLocationError, {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 60000
                });
                
                watchLocationBtn.disabled = true;
                stopWatchBtn.disabled = false;
                
                locationStatus.style.display = 'block';
                locationStatus.textContent = 'æ­£åœ¨ç›‘å¬ä½ç½®å˜åŒ–...';
                locationStatus.className = 'status info';
            }
        });
        
        stopWatchBtn.addEventListener('click', () => {
            if (watchId !== null) {
                navigator.geolocation.clearWatch(watchId);
                watchId = null;
                
                watchLocationBtn.disabled = false;
                stopWatchBtn.disabled = true;
                
                locationStatus.textContent = 'å·²åœæ­¢ç›‘å¬ä½ç½®å˜åŒ–';
                locationStatus.className = 'status success';
            }
        });
        
        // æœ¬åœ°å­˜å‚¨åŠŸèƒ½
        function setLocalStorage() {
            const key = document.getElementById('localKey').value;
            const value = document.getElementById('localValue').value;
            
            if (key && value) {
                localStorage.setItem(key, value);
                getLocalStorage();
            }
        }
        
        function getLocalStorage() {
            const display = document.getElementById('localStorageDisplay');
            let content = '<h4>localStorageå†…å®¹:</h4>';
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                content += `<p><strong>${key}:</strong> ${value}</p>`;
            }
            
            display.innerHTML = content || '<p>localStorageä¸ºç©º</p>';
        }
        
        function clearLocalStorage() {
            localStorage.clear();
            getLocalStorage();
        }
        
        function setSessionStorage() {
            const key = document.getElementById('sessionKey').value;
            const value = document.getElementById('sessionValue').value;
            
            if (key && value) {
                sessionStorage.setItem(key, value);
                getSessionStorage();
            }
        }
        
        function getSessionStorage() {
            const display = document.getElementById('sessionStorageDisplay');
            let content = '<h4>sessionStorageå†…å®¹:</h4>';
            
            for (let i = 0; i < sessionStorage.length; i++) {
                const key = sessionStorage.key(i);
                const value = sessionStorage.getItem(key);
                content += `<p><strong>${key}:</strong> ${value}</p>`;
            }
            
            display.innerHTML = content || '<p>sessionStorageä¸ºç©º</p>';
        }
        
        function clearSessionStorage() {
            sessionStorage.clear();
            getSessionStorage();
        }
        
        // åˆå§‹åŒ–å­˜å‚¨æ˜¾ç¤º
        getLocalStorage();
        getSessionStorage();
        
        // æ–‡ä»¶APIåŠŸèƒ½
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileList = document.getElementById('fileList');
        
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });
        
        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });
        
        function handleFiles(files) {
            fileList.innerHTML = '';
            
            Array.from(files).forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                const fileInfo = document.createElement('div');
                fileInfo.className = 'file-info';
                
                const fileName = document.createElement('div');
                fileName.className = 'file-name';
                fileName.textContent = file.name;
                
                const fileSize = document.createElement('div');
                fileSize.className = 'file-size';
                fileSize.textContent = formatFileSize(file.size);
                
                fileInfo.appendChild(fileName);
                fileInfo.appendChild(fileSize);
                
                const readBtn = document.createElement('button');
                readBtn.className = 'btn';
                readBtn.textContent = 'è¯»å–å†…å®¹';
                readBtn.onclick = () => readFile(file, index);
                
                fileItem.appendChild(fileInfo);
                fileItem.appendChild(readBtn);
                
                fileList.appendChild(fileItem);
            });
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function readFile(file, index) {
            const reader = new FileReader();
            
            reader.onload = (e) => {
                const content = e.target.result;
                
                // åˆ›å»ºé¢„è§ˆçª—å£
                const preview = document.createElement('div');
                preview.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: white;
                    padding: 20px;
                    border-radius: 10px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    max-width: 80%;
                    max-height: 80%;
                    overflow: auto;
                    z-index: 1000;
                `;
                
                if (file.type.startsWith('image/')) {
                    const img = document.createElement('img');
                    img.src = content;
                    img.style.maxWidth = '100%';
                    preview.appendChild(img);
                } else {
                    const pre = document.createElement('pre');
                    pre.textContent = content.substring(0, 1000) + (content.length > 1000 ? '...' : '');
                    pre.style.whiteSpace = 'pre-wrap';
                    preview.appendChild(pre);
                }
                
                const closeBtn = document.createElement('button');
                closeBtn.textContent = 'å…³é—­';
                closeBtn.className = 'btn';
                closeBtn.style.marginTop = '10px';
                closeBtn.onclick = () => document.body.removeChild(preview);
                
                preview.appendChild(closeBtn);
                document.body.appendChild(preview);
            };
            
            if (file.type.startsWith('image/')) {
                reader.readAsDataURL(file);
            } else {
                reader.readAsText(file);
            }
        }
        
        // Web Workers
        const calculateBtn = document.getElementById('calculateBtn');
        const calculateSyncBtn = document.getElementById('calculateSyncBtn');
        const numberInput = document.getElementById('numberInput');
        const workerResult = document.getElementById('workerResult');
        
        // åˆ›å»ºWeb Worker
        const workerCode = `
            self.onmessage = function(e) {
                const num = e.data;
                let result = 1;
                
                for (let i = 1; i <= num; i++) {
                    result *= i;
                }
                
                self.postMessage({
                    number: num,
                    factorial: result,
                    time: Date.now()
                });
            };
        `;
        
        const blob = new Blob([workerCode], { type: 'application/javascript' });
        const workerUrl = URL.createObjectURL(blob);
        
        calculateBtn.addEventListener('click', () => {
            const num = parseInt(numberInput.value);
            const startTime = Date.now();
            
            workerResult.style.display = 'block';
            workerResult.textContent = 'æ­£åœ¨ä½¿ç”¨Web Workerè®¡ç®—...';
            workerResult.className = 'status info';
            
            const worker = new Worker(workerUrl);
            
            worker.postMessage(num);
            
            worker.onmessage = function(e) {
                const endTime = Date.now();
                const result = e.data;
                
                workerResult.innerHTML = `
                    <strong>Web Workerè®¡ç®—ç»“æœ:</strong><br>
                    ${result.number}! = ${result.factorial}<br>
                    è®¡ç®—æ—¶é—´: ${endTime - startTime}ms<br>
                    <em>æ³¨æ„ï¼šé¡µé¢åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ä¿æŒå“åº”</em>
                `;
                workerResult.className = 'status success';
                
                worker.terminate();
            };
        });
        
        calculateSyncBtn.addEventListener('click', () => {
            const num = parseInt(numberInput.value);
            const startTime = Date.now();
            
            workerResult.style.display = 'block';
            workerResult.textContent = 'æ­£åœ¨åŒæ­¥è®¡ç®—ï¼ˆé¡µé¢å¯èƒ½ä¼šå¡é¡¿ï¼‰...';
            workerResult.className = 'status info';
            
            // åŒæ­¥è®¡ç®—ï¼ˆä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼‰
            setTimeout(() => {
                let result = 1;
                for (let i = 1; i <= num; i++) {
                    result *= i;
                }
                
                const endTime = Date.now();
                
                workerResult.innerHTML = `
                    <strong>åŒæ­¥è®¡ç®—ç»“æœ:</strong><br>
                    ${num}! = ${result}<br>
                    è®¡ç®—æ—¶é—´: ${endTime - startTime}ms<br>
                    <em>æ³¨æ„ï¼šé¡µé¢åœ¨è®¡ç®—è¿‡ç¨‹ä¸­è¢«é˜»å¡</em>
                `;
                workerResult.className = 'status success';
            }, 100);
        });
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            console.log('HTML5å¤šåª’ä½“ä¸APIç¤ºä¾‹é¡µé¢å·²åŠ è½½');
        });
    </script>
</body>
</html>